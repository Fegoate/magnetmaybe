# 双站 RCS 插值 Java 实验报告

## 实验目的
根据 AGENT.md 要求，完成双站雷达散射截面（RCS）在任意频率和入射方向下的计算与可视化，并提供可调参数的 Java 图形界面，演示地心坐标系与弹体坐标系的方向转换及插值绘图流程。

## 系统组成与功能
- **RcsApp (Swing 图形界面)**：负责收集频率范围、姿态角（Yaw/Pitch/Roll）、发射机/接收机/目标的经纬高输入，触发计算与绘图。界面左侧为输入面板，右侧显示折线图与方向热力图，计算后在界面上展示入射/散射角度。【F:src/main/java/rcs/RcsApp.java†L17-L155】
- **RcsCalculator (计算调度器)**：以 `SyntheticRcsModel` 为底层模型，提供频率扫频与双站几何计算接口。`geometry` 计算发射/接收点与目标的入射、散射方向并转换到弹体坐标系；`sweep` 生成频率序列并批量求取 RCS；`directionGrid` 计算方向角网格上的 RCS 用于热力图。【F:src/main/java/rcs/RcsCalculator.java†L6-L59】
- **SyntheticRcsModel (合成 RCS 模型)**：模拟基于频率和方向插值的 RCS 变化，包含入射/散射角增益及角度归一化，支持方向网格计算，满足“任意频率、任意入射方向”要求的演示需求。【F:src/main/java/rcs/SyntheticRcsModel.java†L3-L45】
- **GeoPoint 与 Attitude (坐标转换)**：`GeoPoint` 使用 WGS84 椭球将经纬高转换为地心直角坐标 (ECEF)；`Attitude` 构建航向-俯仰-横滚旋转矩阵并提供地心到弹体的矢量变换，支撑“地心坐标系与弹体坐标系的电波传播方向转换”。【F:src/main/java/rcs/GeoPoint.java†L3-L20】【F:src/main/java/rcs/Attitude.java†L3-L65】
- **Vector3 (基础向量运算)**：提供加减、点积、模长与归一化等运算，服务于几何与姿态转换。【F:src/main/java/rcs/Vector3.java†L3-L31】
- **RcsLineChartPanel & DirectionHeatmapPanel (结果可视化)**：
  - 折线图显示频率扫频下的 RCS 曲线，并绘制网格线及频率/RCS 坐标轴刻度，便于读取数值。【F:src/main/java/rcs/RcsLineChartPanel.java†L13-L114】
  - 热力图按方位/俯仰角渲染 RCS 分布，绘制坐标轴刻度与入射/散射方向标记，突出角度参考。【F:src/main/java/rcs/DirectionHeatmapPanel.java†L10-L145】

## 核心流程与关键代码
1. **输入解析与参数收集**：`RcsApp.updateResults` 读取频率范围、姿态角与三点经纬高参数，构造 `Attitude` 与 `GeoPoint` 实例，为后续计算提供数值输入。【F:src/main/java/rcs/RcsApp.java†L122-L155】
2. **坐标转换与角度求取**：`RcsCalculator.geometry` 将经纬高转换为 ECEF 向量，计算入射/散射方向并投影到弹体坐标系，得到方位/俯仰角度输出，用于后续插值与标记。【F:src/main/java/rcs/RcsCalculator.java†L19-L36】
3. **频率扫频与方向网格**：`sweep` 生成等间隔频率点，调用模型计算对应 RCS；`directionGrid` 基于参考入射/散射角生成二维角度网格，为热力图提供数据。【F:src/main/java/rcs/RcsCalculator.java†L38-L59】
4. **插值/合成模型**：`SyntheticRcsModel` 将频率变化项、入射/散射角增益和交叉耦合叠加，体现频率插值与方向敏感度；角度通过 `normalizeAngleDeg` 归一化以处理周期性。【F:src/main/java/rcs/SyntheticRcsModel.java†L3-L45】
5. **图形显示与刻度**：
   - 折线图使用网格、坐标轴刻度与标签呈现频率与 RCS 数值，线段与点突出曲线趋势。【F:src/main/java/rcs/RcsLineChartPanel.java†L35-L103】
   - 热力图按数值范围映射颜色，并在坐标轴绘制刻度、角度标签及入射/散射标记，帮助定位方向。【F:src/main/java/rcs/DirectionHeatmapPanel.java†L52-L145】

## 对 AGENT 要求的实现
- **任意频率与入射方向插值**：`SyntheticRcsModel` 的 `bistaticRcs` 函数结合频率项与角度增益，`directionGrid` 支持任意角度网格计算；`RcsCalculator.sweep` 允许自定义起止频率与点数，实现频率插值演示。【F:src/main/java/rcs/SyntheticRcsModel.java†L3-L25】【F:src/main/java/rcs/RcsCalculator.java†L38-L59】
- **地心/弹体坐标转换**：`GeoPoint.toEcef` 将经纬高转为 ECEF，`Attitude` 生成旋转矩阵完成地心到弹体的方向转换，`geometry` 在此基础上计算入射/散射方位俯仰角。【F:src/main/java/rcs/GeoPoint.java†L3-L20】【F:src/main/java/rcs/Attitude.java†L3-L45】【F:src/main/java/rcs/RcsCalculator.java†L19-L36】
- **参数设置与图形化显示**：`RcsApp` 提供 GUI 输入框和按钮，调用计算后更新折线图与热力图；`RcsLineChartPanel` 与 `DirectionHeatmapPanel` 负责渲染并显示数值刻度，满足“计算结果的图形化显示界面”需求。【F:src/main/java/rcs/RcsApp.java†L45-L155】【F:src/main/java/rcs/RcsLineChartPanel.java†L13-L114】【F:src/main/java/rcs/DirectionHeatmapPanel.java†L10-L145】

## 使用方法概述
在 `java` 目录一次性编译全部源码并运行 Swing 界面：

```bash
javac -d out $(find src/main/java -name "*.java")
java -cp out rcs.RcsApp
```

运行后在左侧输入频率与姿态/经纬高参数，点击“计算并绘图”即可更新 RCS 折线和方向热力图，并在界面上读取入射/散射角度与刻度数值。
